{"version":3,"file":"main.js","sources":["main.js"],"sourcesContent":["jQuery(function($){\n  const $wrap = $('.map__wrapper');\n  const svg   = $wrap.find('svg')[0];\n\n  // Собираем ключи из карточек в порядке показа\n  const keys = $('.map__card').map(function(){ return $(this).data('key'); }).get();\n\n  console.log(keys)\n  let autoIdx = 0, autoTimer = null, isPaused = false;\n\n  // Позиционируем карточки возле соответствующих пинов\n  function positionCards(){\n    const wrapRect = $wrap[0].getBoundingClientRect();\n    $('.map__card').each(function(){\n      const key = $(this).data('key');\n      const node = svg.querySelector('.pin[data-key=\"'+key+'\"]');\n      if(!node) return;\n      const bb = node.getBoundingClientRect();\n      const x = bb.left + bb.width/2 - wrapRect.left;\n      const y = bb.top  - wrapRect.top;\n      // позиция сверху и немного левее центра пина\n      $(this).css({ left: x+'px', top: y+'px' });\n    });\n  }\n\n  function clearActive(){\n    $('.map__card').removeClass('is-visible');\n    $(svg).find('.region, .pin').removeClass('is-active');\n  }\n\n  function showByKey(key){\n    clearActive();\n    $('.map__card[data-key=\"'+key+'\"]').addClass('is-visible');\n    const $region = $(svg).find('.region[data-key=\"'+key+'\"]');\n    const $pin    = $(svg).find('.pin[data-key=\"'+key+'\"]');\n    $region.addClass('is-active');\n    $pin.addClass('is-active');\n  }\n\n  function startAutoplay(){\n    stopAutoplay();\n    autoTimer = setInterval(function(){\n      if(isPaused || keys.length === 0) return;\n      showByKey(keys[autoIdx]);\n      autoIdx = (autoIdx + 1) % keys.length;\n    }, 1800); // скорость \"вспышек\"\n  }\n\n  function stopAutoplay(){\n    if(autoTimer){ clearInterval(autoTimer); autoTimer = null; }\n  }\n\n  // Наведение по региону или пину: показываем нужную карточку и паузим автоплей\n  $(svg).on('mouseenter touchstart', '.region, .pin', function(){\n    isPaused = true;\n    const key = $(this).data('key');\n    if(key) showByKey(key);\n  });\n\n  // Ушли курсором со svg — продолжаем автопоказ\n  $(svg).on('mouseleave touchend', function(){\n    isPaused = false;\n  });\n\n  // Клик по пину/региону — фиксируем карточку до следующего ухода мыши\n  $(svg).on('click', '.region, .pin', function(){\n    const key = $(this).data('key');\n    if(key){\n      stopAutoplay();\n      showByKey(key);\n    }\n  });\n\n  // Восстановить автоплей при уходе мыши с обёртки\n  $wrap.on('mouseleave', function(){\n    isPaused = false;\n    startAutoplay();\n  });\n\n  // Дебаунс-resize для корректной привязки позиций\n  let rAF;\n  function onResize(){ \n    cancelAnimationFrame(rAF);\n    rAF = requestAnimationFrame(positionCards);\n  }\n  $(window).on('load resize', onResize);\n\n  // Инициализация\n  positionCards();\n  showByKey(keys[0]);  // начальный показ первой карточки\n  startAutoplay();\n});\n\n"],"names":["jQuery","$","$wrap","svg","find","keys","map","this","data","get","autoIdx","console","log","autoTimer","isPaused","positionCards","wrapRect","getBoundingClientRect","each","x","key","node","querySelector","bb","left","width","y","top","css","showByKey","removeClass","addClass","$region","$pin","startAutoplay","stopAutoplay","setInterval","length","clearInterval","on","let","rAF","window","cancelAnimationFrame","requestAnimationFrame"],"mappings":"AAAAA,OAAO,SAASC,GACd,IAAMC,EAAQD,EAAE,eAAe,EACzBE,EAAQD,EAAME,KAAK,KAAK,EAAE,GAG1BC,EAAOJ,EAAE,YAAY,EAAEK,IAAI,WAAY,OAAOL,EAAEM,IAAI,EAAEC,KAAK,KAAK,CAAG,CAAC,EAAEC,IAAI,EAG5EC,GADJC,QAAQC,IAAIP,CAAI,EACF,GAAGQ,EAAY,KAAMC,EAAW,CAAA,EAG9C,SAASC,IACP,IAAMC,EAAWd,EAAM,GAAGe,sBAAsB,EAChDhB,EAAE,YAAY,EAAEiB,KAAK,WACnB,IAIMC,EAJAC,EAAMnB,EAAEM,IAAI,EAAEC,KAAK,KAAK,EACxBa,EAAOlB,EAAImB,cAAc,kBAAkBF,EAAI,IAAI,EACrDC,IAEEF,GADAI,EAAKF,EAAKJ,sBAAsB,GACzBO,KAAOD,EAAGE,MAAM,EAAIT,EAASQ,KACpCE,EAAIH,EAAGI,IAAOX,EAASW,IAE7B1B,EAAEM,IAAI,EAAEqB,IAAI,CAAEJ,KAAML,EAAE,KAAMQ,IAAKD,EAAE,IAAK,CAAC,EAC3C,CAAC,CACH,CAOA,SAASG,EAAUT,GAJjBnB,EAAE,YAAY,EAAE6B,YAAY,YAAY,EACxC7B,EAAEE,CAAG,EAAEC,KAAK,eAAe,EAAE0B,YAAY,WAAW,EAKpD7B,EAAE,wBAAwBmB,EAAI,IAAI,EAAEW,SAAS,YAAY,EACzD,IAAMC,EAAU/B,EAAEE,CAAG,EAAEC,KAAK,qBAAqBgB,EAAI,IAAI,EACnDa,EAAUhC,EAAEE,CAAG,EAAEC,KAAK,kBAAkBgB,EAAI,IAAI,EACtDY,EAAQD,SAAS,WAAW,EAC5BE,EAAKF,SAAS,WAAW,CAC3B,CAEA,SAASG,IACPC,EAAa,EACbtB,EAAYuB,YAAY,WACnBtB,GAA4B,IAAhBT,EAAKgC,SACpBR,EAAUxB,EAAKK,EAAQ,EACvBA,GAAWA,EAAU,GAAKL,EAAKgC,OACjC,EAAG,IAAI,CACT,CAEA,SAASF,IACJtB,IAAYyB,cAAczB,CAAS,EAAGA,EAAY,KACvD,CAGAZ,EAAEE,CAAG,EAAEoC,GAAG,wBAAyB,gBAAiB,WAClDzB,EAAW,CAAA,EACX,IAAMM,EAAMnB,EAAEM,IAAI,EAAEC,KAAK,KAAK,EAC3BY,GAAKS,EAAUT,CAAG,CACvB,CAAC,EAGDnB,EAAEE,CAAG,EAAEoC,GAAG,sBAAuB,WAC/BzB,EAAW,CAAA,CACb,CAAC,EAGDb,EAAEE,CAAG,EAAEoC,GAAG,QAAS,gBAAiB,WAClC,IAAMnB,EAAMnB,EAAEM,IAAI,EAAEC,KAAK,KAAK,EAC3BY,IACDe,EAAa,EACbN,EAAUT,CAAG,EAEjB,CAAC,EAGDlB,EAAMqC,GAAG,aAAc,WACrBzB,EAAW,CAAA,EACXoB,EAAc,CAChB,CAAC,EAGDM,IAAIC,EAKJxC,EAAEyC,MAAM,EAAEH,GAAG,cAJb,WACEI,qBAAqBF,CAAG,EACxBA,EAAMG,sBAAsB7B,CAAa,CAC3C,CACoC,EAGpCA,EAAc,EACdc,EAAUxB,EAAK,EAAE,EACjB6B,EAAc,CAChB,CAAC"}