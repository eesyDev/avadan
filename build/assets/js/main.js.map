{"version":3,"file":"main.js","sources":["main.js"],"sourcesContent":["jQuery(function($){\r\n  const $wrap = $('.map__wrapper');\r\n  const svg   = $wrap.find('svg')[0];\r\n\r\n  // Собираем ключи из карточек в порядке показа\r\n  const keys = $('.map__card').map(function(){ return $(this).data('key'); }).get();\r\n\r\n  console.log(keys)\r\n  let autoIdx = 0, autoTimer = null, isPaused = false;\r\n\r\n  // Позиционируем карточки возле соответствующих пинов\r\n  function positionCards(){\r\n    const wrapRect = $wrap[0].getBoundingClientRect();\r\n    $('.map__card').each(function(){\r\n      const key = $(this).data('key');\r\n      const node = svg.querySelector('.pin[data-key=\"'+key+'\"]');\r\n      if(!node) return;\r\n      const bb = node.getBoundingClientRect();\r\n      const x = bb.left + bb.width/2 - wrapRect.left;\r\n      const y = bb.top  - wrapRect.top;\r\n      // позиция сверху и немного левее центра пина\r\n      $(this).css({ left: x+'px', top: y+'px' });\r\n    });\r\n  }\r\n\r\n  function clearActive(){\r\n    $('.map__card').removeClass('is-visible');\r\n    $(svg).find('.region, .pin').removeClass('is-active');\r\n  }\r\n\r\n  function showByKey(key){\r\n    clearActive();\r\n    $('.map__card[data-key=\"'+key+'\"]').addClass('is-visible');\r\n    const $region = $(svg).find('.region[data-key=\"'+key+'\"]');\r\n    const $pin    = $(svg).find('.pin[data-key=\"'+key+'\"]');\r\n    $region.addClass('is-active');\r\n    $pin.addClass('is-active');\r\n  }\r\n\r\n  function startAutoplay(){\r\n    stopAutoplay();\r\n    autoTimer = setInterval(function(){\r\n      if(isPaused || keys.length === 0) return;\r\n      showByKey(keys[autoIdx]);\r\n      autoIdx = (autoIdx + 1) % keys.length;\r\n    }, 1800); // скорость \"вспышек\"\r\n  }\r\n\r\n  function stopAutoplay(){\r\n    if(autoTimer){ clearInterval(autoTimer); autoTimer = null; }\r\n  }\r\n\r\n  // Наведение по региону или пину: показываем нужную карточку и паузим автоплей\r\n  $(svg).on('mouseenter touchstart', '.region, .pin', function(){\r\n    isPaused = true;\r\n    const key = $(this).data('key');\r\n    if(key) showByKey(key);\r\n  });\r\n\r\n  // Ушли курсором со svg — продолжаем автопоказ\r\n  $(svg).on('mouseleave touchend', function(){\r\n    isPaused = false;\r\n  });\r\n\r\n  // Клик по пину/региону — фиксируем карточку до следующего ухода мыши\r\n  $(svg).on('click', '.region, .pin', function(){\r\n    const key = $(this).data('key');\r\n    if(key){\r\n      stopAutoplay();\r\n      showByKey(key);\r\n    }\r\n  });\r\n\r\n  // Восстановить автоплей при уходе мыши с обёртки\r\n  $wrap.on('mouseleave', function(){\r\n    isPaused = false;\r\n    startAutoplay();\r\n  });\r\n\r\n  // Дебаунс-resize для корректной привязки позиций\r\n  let rAF;\r\n  function onResize(){ \r\n    cancelAnimationFrame(rAF);\r\n    rAF = requestAnimationFrame(positionCards);\r\n  }\r\n  $(window).on('load resize', onResize);\r\n\r\n  // Инициализация\r\n  positionCards();\r\n  showByKey(keys[0]);  // начальный показ первой карточки\r\n  startAutoplay();\r\n});\r\n\r\n// const gallerySwiper = new Swiper('.gallery__slider', {\r\n//   centeredSlides: true,\r\n//   slidesPerView: 3, // показываем 5 слайдов (1 активный + по 2 с каждой стороны)\r\n//   spaceBetween: 20,\r\n//   loop: true,\r\n\r\n//   navigation: {\r\n//     nextEl: '.gallery__slider .swiper-button-next',\r\n//     prevEl: '.gallery__slider .swiper-button-prev',\r\n//   },\r\n  \r\n  // breakpoints: {\r\n  //   320: {\r\n  //     slidesPerView: 1.5,\r\n  //     spaceBetween: 10\r\n  //   },\r\n  //   768: {\r\n  //     slidesPerView: 3,\r\n  //     spaceBetween: 15\r\n  //   },\r\n  //   1024: {\r\n  //     slidesPerView: 5,\r\n  //     spaceBetween: 20\r\n  //   }\r\n  // },\r\n  \r\n  // Кастомная анимация глубины БЕЗ прозрачности\r\n\r\n  // on: {\r\n  //   progress: function() {\r\n  //     for (let i = 0; i < this.slides.length; i += 1) {\r\n  //       const slide = this.slides[i];\r\n  //       const slideProgress = slide.progress;\r\n        \r\n  //       // Рассчитываем расстояние от центра (0 = центр)\r\n  //       const distance = Math.abs(slideProgress);\r\n        \r\n  //       // Масштаб: центральный = 1, боковые уменьшаются\r\n  //       const scale = Math.max(0.75, 1 - distance * 0.12);\r\n        \r\n  //       // Z-index для слоев\r\n  //       const zIndex = Math.max(1, 10 - Math.floor(distance * 3));\r\n        \r\n  //       // Применяем трансформации БЕЗ rotate и прозрачности\r\n  //       slide.style.transform = `scale(${scale})`;\r\n  //       slide.style.zIndex = zIndex;\r\n  //     }\r\n  //   },\r\n    \r\n  //   setTransition: function(speed) {\r\n  //     for (let i = 0; i < this.slides.length; i += 1) {\r\n  //       this.slides[i].style.transitionDuration = `${speed}ms`;\r\n  //     }\r\n  //   }\r\n  // }\r\n// });"],"names":["jQuery","$","$wrap","svg","find","keys","map","this","data","get","autoIdx","console","log","autoTimer","isPaused","positionCards","wrapRect","getBoundingClientRect","each","x","key","node","querySelector","bb","left","width","y","top","css","showByKey","removeClass","addClass","$region","$pin","startAutoplay","stopAutoplay","setInterval","length","clearInterval","on","let","rAF","window","cancelAnimationFrame","requestAnimationFrame"],"mappings":"AAAAA,OAAO,SAASC,GACd,IAAMC,EAAQD,EAAE,eAAe,EACzBE,EAAQD,EAAME,KAAK,KAAK,EAAE,GAG1BC,EAAOJ,EAAE,YAAY,EAAEK,IAAI,WAAY,OAAOL,EAAEM,IAAI,EAAEC,KAAK,KAAK,CAAG,CAAC,EAAEC,IAAI,EAG5EC,GADJC,QAAQC,IAAIP,CAAI,EACF,GAAGQ,EAAY,KAAMC,EAAW,CAAA,EAG9C,SAASC,IACP,IAAMC,EAAWd,EAAM,GAAGe,sBAAsB,EAChDhB,EAAE,YAAY,EAAEiB,KAAK,WACnB,IAIMC,EAJAC,EAAMnB,EAAEM,IAAI,EAAEC,KAAK,KAAK,EACxBa,EAAOlB,EAAImB,cAAc,kBAAkBF,EAAI,IAAI,EACrDC,IAEEF,GADAI,EAAKF,EAAKJ,sBAAsB,GACzBO,KAAOD,EAAGE,MAAM,EAAIT,EAASQ,KACpCE,EAAIH,EAAGI,IAAOX,EAASW,IAE7B1B,EAAEM,IAAI,EAAEqB,IAAI,CAAEJ,KAAML,EAAE,KAAMQ,IAAKD,EAAE,IAAK,CAAC,EAC3C,CAAC,CACH,CAOA,SAASG,EAAUT,GAJjBnB,EAAE,YAAY,EAAE6B,YAAY,YAAY,EACxC7B,EAAEE,CAAG,EAAEC,KAAK,eAAe,EAAE0B,YAAY,WAAW,EAKpD7B,EAAE,wBAAwBmB,EAAI,IAAI,EAAEW,SAAS,YAAY,EACzD,IAAMC,EAAU/B,EAAEE,CAAG,EAAEC,KAAK,qBAAqBgB,EAAI,IAAI,EACnDa,EAAUhC,EAAEE,CAAG,EAAEC,KAAK,kBAAkBgB,EAAI,IAAI,EACtDY,EAAQD,SAAS,WAAW,EAC5BE,EAAKF,SAAS,WAAW,CAC3B,CAEA,SAASG,IACPC,EAAa,EACbtB,EAAYuB,YAAY,WACnBtB,GAA4B,IAAhBT,EAAKgC,SACpBR,EAAUxB,EAAKK,EAAQ,EACvBA,GAAWA,EAAU,GAAKL,EAAKgC,OACjC,EAAG,IAAI,CACT,CAEA,SAASF,IACJtB,IAAYyB,cAAczB,CAAS,EAAGA,EAAY,KACvD,CAGAZ,EAAEE,CAAG,EAAEoC,GAAG,wBAAyB,gBAAiB,WAClDzB,EAAW,CAAA,EACX,IAAMM,EAAMnB,EAAEM,IAAI,EAAEC,KAAK,KAAK,EAC3BY,GAAKS,EAAUT,CAAG,CACvB,CAAC,EAGDnB,EAAEE,CAAG,EAAEoC,GAAG,sBAAuB,WAC/BzB,EAAW,CAAA,CACb,CAAC,EAGDb,EAAEE,CAAG,EAAEoC,GAAG,QAAS,gBAAiB,WAClC,IAAMnB,EAAMnB,EAAEM,IAAI,EAAEC,KAAK,KAAK,EAC3BY,IACDe,EAAa,EACbN,EAAUT,CAAG,EAEjB,CAAC,EAGDlB,EAAMqC,GAAG,aAAc,WACrBzB,EAAW,CAAA,EACXoB,EAAc,CAChB,CAAC,EAGDM,IAAIC,EAKJxC,EAAEyC,MAAM,EAAEH,GAAG,cAJb,WACEI,qBAAqBF,CAAG,EACxBA,EAAMG,sBAAsB7B,CAAa,CAC3C,CACoC,EAGpCA,EAAc,EACdc,EAAUxB,EAAK,EAAE,EACjB6B,EAAc,CAChB,CAAC"}